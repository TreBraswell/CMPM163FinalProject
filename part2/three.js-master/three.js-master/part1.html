<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Testing TextGeo</title>
  <style>
    body {
      margin: 0;
    }

    canvas {
      display: block;
    }
  </style>
</head>

<body>
  <script src="../three.js-master/build/three.js"></script>
  <script>

    var loaded = false;
    var camera, scene, renderer;
    var material = new THREE.MeshNormalMaterial();
    var amountc = 40;
    var amountr = 25;
    var r;
    var gone = ["boy", "what", "are", "you", "doing", "with", "that", "head", "look", "at", "the", "top", "of", "his", "head"]
    var group = [];
    init();
    animate();
    var sizediff = 5;
    var filetxt;
    var i =0;
    var loaded2 =false;
    function init() {

      camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 50);
      camera.position.z = 8;

      scene = new THREE.Scene();
      var loadertext = new THREE.FontLoader();
     loadertext.load(
	// resource URL
	'example.txt',
    
	// onLoad callback
	function ( data ) {
		// output the text to the console
		filetxt = data;
    loaded2 = true;
	},

	// onProgress callback
	function ( xhr ) {
		console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );
	},

	// onError callback
	function ( err ) {
		console.error( 'An error happened' );
	}
);
  if(loaded2)
  {
    filetxt = filetxt.toLowerCase()
    var final= filetxt.trim().split(" ");
    var b ;
    /*for( b = 0; b< final.length; b++)
    {
      final[b].replace( /[^a-z]/g, '' );
    }*/
   
    final.sort(() => Math.random() - 0.5);
  }
     
      var loader = new THREE.FontLoader();
      loader.load('Font_updated_Regular.json', function (font) {
        //r= -20 && c= -40
        for (r = 0; r < amountr; r+=sizediff+1) {
          for (c = 0; c < amountc; c+=sizediff+1) {
            if(i>=final.length)
            {
              i = 0;
              final.sort(() => Math.random() - 0.5);
            }
            var geometry = new THREE.TextGeometry(final[i], {
              font: font,
              size: 2,
              height: 2,
              curveSegments: 4,
              bevelEnabled: true,
              bevelThickness: 0.02,
              bevelSize: 0.05,
              bevelSegments: 3
            });
            var mesh = new THREE.Mesh(geometry, material);
            var child = mesh.clone();
            child.position.z =-28;
            child.position.y = r;
            child.position.x =c;
            //child.position.z = -10;
            child.lookAt(0,0,-28);
            group.push(child);
            scene.add(child);
          }
        }
        loaded = true;
        //console.log(group); 
      });
      //console.log(group.length);
      //console.log(group.length);
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(840, 480);
      document.body.appendChild(renderer.domElement);

      //

     

    }

    function animate() {
      var i;
      if(loaded)
      {
        camera.rotation.y ++;
       // group.position.z++
      for (i = 0; i <  group.length; i++) {
        
        
          //console.log(group);
          console.log(group.length);
         group[i].position.z= group[i].position.z+.3;
        if (group[i].position.z > 20) {
          group[i].position.z = -28;
        }
        }
      
      }
      //console.log("test");
      requestAnimationFrame(animate);
      renderer.render(scene, camera);

    }

    animate();




  </script>
</body>

</html>